from random import *
    
'''å·¥äººAï¼ˆå‘ç‰Œå‘˜ï¼‰ï¼Œä»…å‘ç‰Œï¼Œä¸€äººquantityå¼ ç‰Œï¼Œåªè¿”å›æ‰‹ç‰Œã€‚'''
def deal_initial_cards(cards, player, pc, quantity): 
    for i in range(quantity): 
        a = choice(cards)   
        b = choice(cards)        
        player.append(a)
        pc.append(b)
    return player, pc  # returnä»£è¡¨å‡½æ•°å®šä¹‰çš„ç»“æŸï¼Œä¸å†å‘ä¸‹è¿è¡Œï¼Œä¸ºäº†åç»­è®¡ç®—å’Œæµç¨‹æ§åˆ¶å¯ä»¥åŠ ä¸Šï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚

'''å·¥äººBï¼ˆç‚¹æ•°è®¡ç®—å‘˜ï¼‰ï¼Œåˆ†ä¸¤æ­¥å¤„ç†ï¼ˆå…ˆå¤„ç†éAç‰Œï¼Œå†å¤„ç†Aç‰Œï¼‰è®¡ç®—playeræˆ–pcæ‰‹ä¸­ç‰Œç»„çš„ç‚¹æ•°å’Œï¼Œå…ˆåªè®¡æ•°Aï¼Œç„¶åæœ‰ä¸€ä¸ªAå°±åŠ 11æˆ–1ã€‚'''
def calculate_score(hand):  #ç»™å·¥äººbä¸€ä¸ªå‚æ•°handï¼Œè®©å‡½æ•°çŸ¥é“è‡ªå·±è®¡ç®—çš„æ˜¯å“ªå¹…æ‰‹ç‰Œã€‚
    total = 0 #è®¾å®šåˆå§‹æ€»å’Œä¸º0
    ace_count = 0 #å¢åŠ ä¸€ä¸ªè®¡æ•°å˜é‡ï¼Œç”¨äºç»Ÿè®¡æ‰‹ç‰Œé‡Œæœ‰æ²¡æœ‰Aï¼Œå¦‚æœæœ‰å°±åŠ ä¸€ä¸ª
    for card in hand:
        if card == 'A': #å¦‚æœæ‰‹ç‰Œæ˜¯Aï¼Œåˆ™è®¡æ•°1ï¼Œä¸æ±‚å’Œ
            ace_count += 1        
        elif card in ['J', 'Q', 'K']:#åˆ©ç”¨å­—å…¸æ˜ å°„å–å€¼ï¼Œå¦‚æœcardä¸ºJQKï¼Œåˆ™ç›´æ¥æ€»å’ŒåŠ 10
            total += 10
        else:
            total += int(card)  #å…¶ä»–æƒ…å†µä¸‹åŠ ä¸Šcardæœ¬èº«ï¼Œ
    #æŠŠAæ”¾è¿›æ¥åˆ¤æ–­æ˜¯1è¿˜æ˜¯11ï¼Œè®¡ç®—ç‚¹æ•°å’Œã€‚
    for _ in range(ace_count): #ç”¨ä¸‹åˆ’çº¿è¡¨ç¤ºä¸éœ€è¦ä½¿ç”¨å¾ªç¯å˜é‡ï¼Œç©å®¶æ‰‹ä¸­æœ‰å‡ å¼ Aå°±æ‰§è¡Œå‡ æ¬¡å¾ªç¯è®¡æ•°
        if total + 11 > 21: #å¦‚æœåŠ æ€»å¤§äº21ç‚¹ï¼Œåˆ™æŠŠAä½œä¸º1ï¼Œå¦åˆ™ä½œä¸º11
            total += 1
        else:
            total +=11
    return total #è¾“å‡ºplayeræ‰‹ä¸­å½“å‰ç‰Œç»„å€¼ä¹‹å’Œ

'''å·¥äººCï¼ˆç©å®¶äº’åŠ¨å‘˜ï¼‰ï¼Œè¯¢é—®ç©å®¶æ˜¯å¦è¦ç‰Œï¼Œå¹¶è¿”å›ç©å®¶æ‰‹ç‰Œã€‚'''
def player_turn(player, cards):
    player_choice = input("æ˜¯å¦ç»§ç»­è¦ç‰Œï¼Ÿç»§ç»­è¯·è¾“å…¥Yï¼Œæ”¾å¼ƒè¯·è¾“å…¥Nã€‚").strip().lower()
    if player_choice == "y":
        player_addition = choice(cards)  #ç©å®¶è·å¾—ç¬¬ä¸‰å¼ ç‰Œ
        player.append(player_addition) #æ›´æ–°ç©å®¶æ‰‹ä¸­ä¸‰å¼ ç‰Œç»„
    return player, player_choice #è¿”å›ç©å®¶æ‰‹ç‰Œå’Œç©å®¶é€‰æ‹©

'''å·¥äººDï¼ˆç‚¹æ•°è®¡ç®—å‘˜ï¼‰ï¼šæœ€æ–°å‘ç‰Œåç«‹å³è¿›è¡Œè®¡æ•°æ£€æŸ¥ï¼Œåˆ¤æ–­ç©å®¶æ˜¯å¦çˆ†ç‰Œã€‚å¯ä»¥ç›´æ¥ç”¨æœ€æ–°çš„playerè°ƒç”¨å‡½æ•°calculate_score()ã€‚'''
'''å·¥äººEï¼ˆç”µè„‘é€»è¾‘å‘˜ï¼‰ï¼šcomputer_turn(computer_hand) -> ç©å®¶åœç‰Œåï¼Œæ ¹æ®å›ºå®šè§„åˆ™ï¼ˆå¦‚<17ç‚¹è¦ç‰Œï¼‰å¾ªç¯ä¸ºç”µè„‘å‘ç‰Œã€‚'''
def computer_turn(pc, cards):
    while calculate_score(pc) < 17: #è®¡ç®—æ‰‹ç‰Œæ€»å’Œï¼Œç”¨whileå®ç°æ±‚å’Œå¾ªç¯ï¼Œä¸€ç›´åˆ°è¶…è¿‡17æ—¶åœæ­¢æ¥æ”¶æ‰‹ç‰Œ
            pc_addition = choice(cards)  #pcè·å¾—æ–°ç‰Œ
            pc.append(pc_addition) #æ›´æ–°pcæ‰‹ä¸­ç‰Œç»„
    return pc  

'''å·¥ä½œF è£åˆ¤å‘˜ é¦–å…ˆæ£€æŸ¥ç©å®¶å’Œç”µè„‘æ˜¯å¦çˆ†ç‰Œï¼ˆè¶…è¿‡21ç‚¹ï¼‰ï¼Œç„¶åæ¯”è¾ƒä¸¤è€…ç‚¹æ•°å¤§å°å†³å®šèƒœè´Ÿï¼Œç‚¹æ•°ç›¸åŒåˆ™åˆ¤ä¸ºå¹³å±€ã€‚å¦‚å‰ä¸¤å¼ ç‰Œç›´æ¥è¾¾åˆ°21ç‚¹æ—¶ï¼Œåˆ™å®£å¸ƒä¸º"Blackjack"å¹¶ç»™äºˆå¥–åŠ±åˆ¤å®šã€‚'''
def judge_winner(player_hand, pc_hand):
#ç¬¬1æ­¥ï¼šç®—åˆ†æ•°
    ts_player = calculate_score(player_hand) #è®¡ç®—ç©å®¶æ‰‹ç‰Œç‚¹æ•°æ€»å’Œ
    tc_player = len(player_hand) #è®¡ç®—åˆ—è¡¨é•¿åº¦ï¼Œä¹Ÿå³ç©å®¶æ‰‹ç‰Œæ•°é‡
    ts_pc = calculate_score(pc_hand) #è®¡ç®—pcæ‰‹ç‰Œç‚¹æ•°æ€»å’Œ
    tc_pc = len(pc_hand) #è®¡ç®—åˆ—è¡¨é•¿åº¦ï¼Œä¹Ÿå³åˆ—è¡¨æ‰‹ç‰Œæ•°é‡
# ç¬¬2æ­¥ï¼šå¦‚æœæœ‰äººBlackjack â†’ æŒ‰Blackjackè§„åˆ™åˆ¤ã€‚
    player_bj =  ts_player == 21 and tc_player ==2 #ç©å®¶åˆ¤å®šblackjack
    pc_bj = ts_pc == 21 and tc_pc ==2 #ç”µè„‘åˆ¤å®šblackjack
    if player_bj and pc_bj :
        result = "å¹³å±€"
    elif player_bj :
        result = "ç©å®¶blackjackï¼ğŸ‰æ­å–œï¼ä½ ç®€ç›´æ˜¯å¤©é€‰ä¹‹å­ï¼Œå†æ¥ä¸€æ¬¡å§ï¼"
        sleep(1.5)
    elif pc_bj:
        result = "ç”µè„‘blackjackï¼èœé¸¡ï¼Œå†æ¥ä¸€æ¬¡å§ï¼" 
        sleep(1.5)
# ç¬¬3æ­¥ï¼šå¦‚æœæœ‰äººçˆ†ç‰Œ â†’ çˆ†ç‰Œçš„äººè¾“  
    if ts_player > 21 : #åŒæ–¹éƒ½çˆ†ç‰Œæ—¶ï¼Œé€šå¸¸åˆ¤å…ˆçˆ†çš„äººè¾“ï¼ˆç©å®¶å…ˆçˆ†ï¼‰
        result =  "ğŸ’¥ ç©å®¶çˆ†ç‰Œï¼ç”µè„‘èµ¢ï¼è°è®©ä½ æ˜¯äººï¼Œå†æ¥ä¸€æ¬¡å§ï¼"
        sleep(1.5)
    if ts_player <= 21 and ts_pc > 21:
        result = "ğŸ’¥ ç”µè„‘çˆ†ç‰Œï¼ç©å®¶èµ¢ï¼ğŸ‰æ­å–œå–ï¼Œå†æ¥ä¸€æ¬¡å§ï¼"
# ç¬¬4æ­¥ï¼šéƒ½æ²¡é—®é¢˜ â†’ æ¯”è°åˆ†æ•°å¤§
    if ts_player <= 21 and ts_pc <= 21:
        if ts_player > ts_pc:
            result = "ğŸ‰æ­å–œï¼èœé¸¡è·èƒœï¼Œæ’’èŠ±æ’’èŠ±ï¼Œå†æ¥ä¸€æ¬¡å§ï¼"
        elif ts_player < ts_pc:
            result = "å•Šå“¦ï¼Œå¤ªé—æ†¾å•¦ï¼Œå¤ªèœé¸¡ï¼Œç”µè„‘èµ¢äº†ï¼Œå†æ¥ä¸€æ¬¡å§ï¼"
        else:
            result =  "å¹³å±€ï¼Œå¤ªå¯æƒœå•¦ï¼Œå†æ¥ä¸€æ¬¡å§ï¼"
    #return result + "\nç©å®¶çš„æ‰‹ç‰Œæ˜¯{},ç”µè„‘çš„æ‰‹ç‰Œæ˜¯{}".format(player,pc)
    return f"{result}\nç©å®¶çš„æ‰‹ç‰Œæ˜¯{player_hand},ç”µè„‘çš„æ‰‹ç‰Œæ˜¯{pc_hand} "
    #print("æ¯”èµ›ç»“æŸã€‚æ¯”èµ›ç»“æœä¸ºï¼š{}".format(result))

'''å·¥ä½œGè°ƒåº¦å‘˜ï¼ˆä¸»å‡½æ•°ï¼‰ï¼šplay_game() -> ç»„è£…ï¼ŒæŒ‰é¡ºåºåè°ƒæ‰€æœ‰å·¥äººå·¥ä½œã€‚'''
def play_game(): #å‡½æ•°å®šä¹‰defåªæ˜¯"è®°ä¸‹åšæ³•"ï¼Œä¸æ‰§è¡Œé‡Œé¢çš„ä»£ç ï¼Œåœ¨è°ƒç”¨main()æ—¶ï¼Œå˜é‡å·²ç»å®šä¹‰å¥½äº†ï¼Œå‚æ•°ä¼ é€’æ­£å¸¸ï¼Œä¸»å‡½æ•°æ”¾åœ¨æœ€åä¸ä¼šå½±å“å‰é¢å‡½æ•°çš„å®šä¹‰ã€‚

    cards = ["A", "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K"] #è®¾ç½®ç‰Œå †
    player = []  #ç»™ç©å®¶å‡†å¤‡ä¸€ä¸ªç‰Œç»„
    pc = []  #ç»™ç©å®¶å‡†å¤‡ä¸€ä¸ªç‰Œç»„
    quantity = 2 #è®¾ç½®åˆå§‹æ‰‹ç‰Œæ•°é‡
    result = "" #å­˜å‚¨æ¯”èµ›ç»“æœ
    
    print("="*70)
    print("ğŸ°æ¬¢è¿æ¥åˆ°21ç‚¹æ¯”èµ›ç°åœºï¼Œä½ å‡†å¤‡å¥½äº†å—ï¼Ÿæ¸¸æˆç°åœ¨å¼€å§‹ï¼")
    print("="*70)
    sleep(1.5)  # æš‚åœ1.5ç§’ï¼Œæ—¶é—´å¯è°ƒæ•´
    
    print("ç°åœ¨å¼€å§‹å‘ç‰Œï¼Œæ¯ä½ç©å®¶å„è·å¾—ä¸¤å¼ åˆå§‹æ‰‹ç‰ŒğŸƒã€‚")
    print("å‘ç‰Œä¸­" + "."*70)
    sleep(2)  
    deal_initial_cards(cards, player, pc, quantity)
    print("ç©å®¶çš„æ‰‹ç‰Œæ˜¯{}".format(player))
    sleep(3) 
    splayer = calculate_score(player) 
    spc = calculate_score(pc)
    if splayer >=21 or spc >= 21:
        print(judge_winner(player,pc))
        sleep(4) 
    else:
        print("="*70)
        print("å‘ç‰Œå®Œæˆï¼ŒğŸ‘¤è¯·ç©å®¶é€‰æ‹©æ˜¯å¦ç»§ç»­æŠ½ç‰Œã€‚")
        sleep(2) 
        print("="*70)
        palyer, choice = player_turn(player,cards)
        while choice == "y":
            print("ç©å®¶çš„æ‰‹ç‰Œæ˜¯{}".format(player))
            sleep(3) 
            splayer = calculate_score(player) 
            palyer, choice = player_turn(player,cards)
        if splayer >= 21 :
            r  = judge_winner(player,pc)
            print(r)   
            sleep(4) 
        else:
            print("="*40)
            print("ç©å®¶å›åˆç»“æŸï¼ŒğŸ¤–è¯·ç”µè„‘è¡ŒåŠ¨ã€‚")
            print("="*40)   
            sleep(1.5) 
            calculate_score(pc)
            print(judge_winner(player,pc))
            sleep(4) 
            
'''éœ€è¦è¿è¡Œå°è£…å¥½çš„ä¸»å‡½æ•°main()ï¼Œå¢åŠ ä¸€ä¸ªå†ç©ä¸€æ¬¡çš„é€‰é¡¹'''
if __name__ == "__main__": # ç»™pyæ–‡ä»¶å¢åŠ ä¸€ä¸ªä½¿ç”¨å¼€å…³ï¼Œimportæ—¶ä¸ä¼šè‡ªåŠ¨è¿è¡Œ
    game_result = play_game()
    play_again = input("\næ˜¯å¦å†ç©ä¸€æ¬¡ï¼Ÿ(Y/N): ").strip().lower() # è¯¢é—®æ˜¯å¦å†ç©ä¸€æ¬¡
    while play_again == 'y':
        print("\n" + "="*40)
        sleep(3) 
        play_game()
        play_again = input("\næ˜¯å¦å†ç©ä¸€æ¬¡ï¼Ÿ(Y/N): ").strip().lower() #å¯ä»¥æ— é™æ¬¡æ•°æ¸¸æˆ
    print("ğŸ® æ¸¸æˆç»“æŸï¼Œæˆ‘ä»¬ä¸‹æ¬¡å†è§ï¼")
    sleep(3) 
    
input("æ¸¸æˆç»“æŸï¼Œè¯·æŒ‰å›è½¦é”®å…³é—­çª—å£...")  # ç­‰å¾…ç”¨æˆ·å›è½¦ç¡®è®¤


